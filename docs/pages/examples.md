Learn Allspark by example. This assumes you've already accumulated the knowledge from the [guides](../guides) chapter.

<br>

## Examples

This page contains a series of solutions to specific problems.

<br>

### Command Shorthand

<img width=381 src=https://user-images.githubusercontent.com/2152766/60725113-2e90d100-9f30-11e9-9fe5-866e7038a3fa.png></h3>

Use `rez env` to establish a context, and `--command` to immediately run a command within that context.

```powershell
rez env --command="echo Hello"
```

Instead of using `--command`, you can also use `--`.

```powershell
rez env -- echo Hello
```

Note that you didn't need quotation marks or an `=` sign for this to work, and that it's a little easier on the eyes. We use this syntax extensively throughout this guide.

<br>

## External Packages

With Rez you can package almost anything, but sometimes there are packages already made for you to benefit from.

<br>

### Install from PyPI

Managing external projects is no fun unless you can benefit from what package authors in neighboring ecosystems have been working on. PyPI is such an ecosystem and you can install any package from PyPI as a Rez package using `rez-pipz`.

```bash
git clone https://github.com/mottosso/rez-pipz.git
cd rez-pipz
rez build --install
```

Here's how you use it.

```bash
rez env pipz -- install six
```

- See [rez-pipz](https://github.com/mottosso/rez-pipz) for details.

<br>

### Install from Scoop

Scoop is a package manager for Windows. It's akin to [Chocolatey](), except packages are portable and doesn't require adminstrative access, which makes it a perfect fit for Rez.

```bash
git clone https://github.com/mottosso/rez-scoopz.git
cd rez-scoopz
rez build --install
```

Here's how you use it.

```bash
rez env scoopz -- install python
```

- See [rez-scoopz](https://github.com/mottosso/rez-scoopz) for details.

<br>

## Windows Gotchas

Here are a few things to keep in mind when working with Rez on Windows.

<br>

### `alias()` on Windows with `cmd`

- Utilises `doskey`, which works similar to `alias` on Linux
- Does not work with `rez env -- arbitrary command`
- Does not carry across shell, e.g. `start`
- Does not respect cmd.exe scope, e.g. `cmd /Q /K doskey python=c:\python27\python.exe $*` affects parent too

<br>

### Process Tree

Virtualenv is one way of using Rez on Windows, and if you do then the `rez.exe` executable is generated during `pip install` and works by spawning a `python.exe` process, also generated by `pip`, which in turn calls on your system `python.exe`. Here's what spawning your own Python session from within a Rez context looks like.

![image](https://user-images.githubusercontent.com/2152766/59964221-e6b48780-94f5-11e9-8300-390d0587f5e3.png)

<br>

### cmd and 2,000 characters

`cmd.exe` is both familiar and available on every Windows machine dating back to Windows 95. It does however suffer from one major limitation; environment variables are limited in length to 2,000 characters.

It isn't quite as simple as that, as there is a limit in the Windows API, another limit in `conhost.exe` and yet another in `cmd.exe`. When using Rez with `cmd.exe`, it is this limit you must take into consideration, and it is the most limiting of them all.

To work around this issue, it is recommended that you use PowerShell on Windows.

**rezconfig.py**

```powershell
default_shell = "powershell"
```

<br>

### platform_map

You'll want to use a brutal [`platform_map`](https://github.com/mottosso/bleeding-rez/wiki/Configuring-Rez#platform_map) for your Windows setup, because of stunts like this.

**Machine A**

```bash
$ C:\Users\marcus\Desktop>systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
OS Name:                   Microsoft Windows 10 Pro
OS Version:                10.0.17134 N/A Build 17134
$ python
>>> import platform
>>> platform.platform()
'Windows-8-6.2.9200'
>>> from rez.utils.platform_ import platform_
>>> platform_.os
'windows-6.2.9200'
```

**Machine B**

```bash
$ C:\Users\marcus\Desktop>systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
OS Name:                   Microsoft Windows 10 Pro
OS Version:                10.0.18362 N/A Build 18362
$ python
>>> import platform
>>> platform.platform()
'Windows-10-10.0.18362'
>>> from rez.utils.platform_ import platform_
>>> platform_.os
'windows-10.0.18362.SP0'
```

**rezconfig.py**

For a `platform_map`, try this one on for size. I'll make any modern version of Windows (8-10) into Windows 10.

```py
platform_map = {
    "os": {
        r"windows-6(.*)": r"windows-10",
        r"windows-10(.*)": r"windows-10",
    },
}
```

<br>

### Maya and Quicktime

Typically, playblasting to `.mp4` or `.mov` with Maya requires a recent install of Quicktime on the local machine. Let's have a look at how to approach this with Rez.

> How *does* one approach this with Rez? Submit [a PR](https://github.com/mottosso/allspark) today!
